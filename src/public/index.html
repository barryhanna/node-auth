<!DOCTYPE html>
<html lang="en-GB">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;600;700&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Karla', sans-serif;
		}

		input,
		textarea,
		button {
			font-family: inherit;
			height: 30px;
			border-radius: 2px;
		}

		button {
			border: none;
		}

		input,
		textarea {
			padding-inline: 5px;
			border: 1px solid #333;
		}

		input:focus,
		textarea:focus {
			outline: 4px dashed violet;
		}

		hr+h3 {
			margin-top: 3rem;
		}
	</style>
	<title>Node Auth 1 - Level Up</title>
</head>

<body>
	<h1>Hello</h1>
	<h3>Register Form</h3>
	<form id="register-form">
		<input type="email" name="email">
		<input type="password" name="password">
		<button type="submit">Register</button>
	</form>
	<hr>
	<h3>Login Form</h3>
	<form id="login-form">
		<input type="email" name="email">
		<input type="password" name="password">
		<button type="submit">Login</button>
	</form>
	<script>
		;
		(() => {
			const registerForm = document.getElementById('register-form');
			registerForm.addEventListener("submit", async (e) => {
				e.preventDefault();
				try {
					const values = Object.values(registerForm).reduce((obj, field) => {
						if (field.name) {
							obj[field.name] = field.value;
						}
						return obj;
					}, {})
					console.log("values", values);
					const res = await fetch("/api/register", {
						method: "POST",
						body: JSON.stringify(values),
						headers: {
							"Content-type": "application/json; charset=UTF-8"
						},
					})
					const result = res.json();
					console.log(result)
				} catch (e) {
					console.error(e);
				}
			});

			const loginForm = document.getElementById('login-form');
			loginForm.addEventListener("submit", async (e) => {
				e.preventDefault();
				try {
					const values = Object.values(loginForm).reduce((obj, field) => {
						if (field.name) {
							obj[field.name] = field.value;
						}
						return obj;
					}, {})
					console.log("values", values);
					const res = await fetch("/api/authorize", {
						method: "POST",
						body: JSON.stringify(values),
						headers: {
							"Content-type": "application/json; charset=UTF-8"
						},
					})
					const result = res.json();
					console.log(result)
				} catch (e) {
					console.error(e);
				}
			});
		})();
	</script>
</body>

</html>